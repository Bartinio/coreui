<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>New Components</title>
    <link rel="stylesheet" href="../../../dist/css/coreui.min.css">

  </head>
  <body style="margin:50px">

    <h1>CoreUI</h1>


    <div class="alert alert-primary" role="alert">This is a primary alert—check it out!</div>

    <div class="alert alert-warning alert-dismissible fade show" role="alert" id="alert1"><strong>Holy guacamole!</strong> You should check in on some of those fields below.
      <button class="close" type="button" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>

    <div class="alert alert-warning alert-dismissible fade show" role="alert"><strong>Holy guacamole!</strong> You should check in on some of those fields below.
      <button class="close" type="button" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>

    <hr>

    <div class="dropdown">
      <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        Dropdown button
      </button>
      <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
        <a class="dropdown-item" href="#">Action</a>
        <a class="dropdown-item" href="#">Another action</a>
        <a class="dropdown-item" href="#">Something else here</a>
      </div>
    </div>

    <hr>
    <br>
    <h1>New Components</h1>

    <br>
    <h1>LoadingButton</h1>

    <button class="btn btn-default c-loading-button" data-time="6" id="lb1">
      loading button 1 with spinner, data-time attribute
      <div class="spinner-grow spinner-grow-sm" data-target="loading-button"></div>
    </button>

    <button class="btn btn-default c-loading-button" data-time="0.5" data-stripe-color="rgba(255, 0, 0, 0.2)" id="lb2">
      loading button 2 without spinner, jQuery initialized
    </button>

    <button class="btn btn-default c-loading-button" data-coreui="loading-button" data-time="5">
      loading button 3 with spinner, data-time attribute and auto initialization
      <div class="spinner-grow spinner-grow-sm" data-target="loading-button"></div>
    </button>

    <br>
    <hr>
    <h1>MultiSelect</h1>

    <div class="c-select" id="multi1">

      <div class='c-tag-area'></div>

      <div class='c-select-search'>
        <input type="text" />
      </div>

      <ul data-list>
        <li value="1">an option 1</li>
        <li>a long long option 2</li>
        <li value="3">option 3</li>
        <li class="c-label">Label</li>
        <ul>
          <li>group option 1</li>
          <li>group option 2</li>
          <li class="c-label">Label 2</li>
          <ul>
            <li>group option 3</li>
            <li>group option 4</li>
          </ul>
        </ul>
        <li value="5">option 5</li>
        <li value="6">option 6</li>
      </ul>

    </div>
    <hr>
    <button class='btn btn-default' onclick='alertValue()'>Get value</button>

    <br>
    <hr>
    <h1>Datatable</h1>
    <div data-items-per-page="8" id="t1"></div>

    <br>
    <hr>
    <h1>Pagination</h1>
    <div id="pag1"></div>



    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="../../../dist/js/coreui.bundle.js"></script>

    <script>

      var multiSelect;
      var details = [];
      var datatable;

      function alertValue(){
        alert(multiSelect.value());
      }

      const toggleDetails = (index) => {
        const position = details.indexOf(index)
        let newDetails = details.slice()
        if (position !== -1) {
          newDetails.splice(position, 1)
        } else {
          newDetails = [...details, index]
        }
        details = newDetails
        datatable.render();
      }

      function main(){

          // alert

          var alertEl = document.getElementById('alert1');
          var alert = new coreui.Alert(alertEl);
          alert = new coreui.Alert(alertEl);


          // loading buttons

          //1

          var myLoadingButton = document.getElementById('lb1');
          var loadingButton = new coreui.LoadingButton(myLoadingButton, {
            progress:50
          });
          /*
          // try: second initialization
          loadingButton = new coreui.LoadingButton(myLoadingButton, {
            progress:50
          });
          */
          myLoadingButton.addEventListener('start.coreui.loadingbutton', function () {
            console.log('start event');
          })
          loadingButton.start();

          //2
          /*
          //
          var myLoadingButton2 = document.getElementById('lb2');
          var loadingButton2 = new coreui.LoadingButton(myLoadingButton2);
          console.log(loadingButton2);
          */

          //jQuery
          $('#lb2').loadingbutton();
          //$('#lb2').loadingbutton('start');


          //template
          //inicjacja w stylu jQuery
          //$('#t1').template();


          // Datatable

          // data

          const fields = [
            { key: 'name', _style: { width: '40%'} },
            'registered',
            { key: 'role', _style: { width: '20%'} },
            { key: 'status', _style: { width: '20%'} },
            {
              key: 'show_details',
              label: '',
              _style: { width: '1%' },
              sorter: false,
              filter: false
            }
          ]

          const usersData = [
            {id: 0, name: 'John Doe', registered: '2018/01/01', role: 'Guest', status: 'Pending'},
            {id: 1, name: 'Samppa Nori', registered: '2018/01/01', role: 'Member', status: 'Active'},
            {id: 2, name: 'Estavan Lykos', registered: '2018/02/01', role: 'Staff', status: 'Banned'},
            {id: 3, name: 'Chetan Mohamed', registered: '2018/02/01', role: 'Admin', status: 'Inactive'},
            {id: 4, name: 'Derick Maximinus', registered: '2018/03/01', role: 'Member', status: 'Pending'},
            {id: 5, name: 'Friderik Dávid', registered: '2018/01/21', role: 'Staff', status: 'Active'},
            {id: 6, name: 'Yiorgos Avraamu', registered: '2018/01/01', role: 'Member', status: 'Active'},
            {id: 7, name: 'Avram Tarasios', registered: '2018/02/01', role: 'Staff', status: 'Banned'},
            {id: 8, name: 'Quintin Ed', registered: '2018/02/01', role: 'Admin', status: 'Inactive'},
            {id: 9, name: 'Enéas Kwadwo', registered: '2018/03/01', role: 'Member', status: 'Pending'},
            {id: 10, name: 'Agapetus Tadeáš', registered: '2018/01/21', role: 'Staff', status: 'Active'},
            {id: 11, name: 'Carwyn Fachtna', registered: '2018/01/01', role: 'Member', status: 'Active'},
            {id: 12, name: 'Nehemiah Tatius', registered: '2018/02/01', role: 'Staff', status: 'Banned'},
            {id: 13, name: 'Ebbe Gemariah', registered: '2018/02/01', role: 'Admin', status: 'Inactive'},
            {id: 14, name: 'Eustorgios Amulius', registered: '2018/03/01', role: 'Member', status: 'Pending'},
            {id: 15, name: 'Leopold Gáspár', registered: '2018/01/21', role: 'Staff', status: 'Active'},
            {id: 16, name: 'Pompeius René', registered: '2018/01/01', role: 'Member', status: 'Active'},
            {id: 17, name: 'Paĉjo Jadon', registered: '2018/02/01', role: 'Staff', status: 'Banned'},
            {id: 18, name: 'Micheal Mercurius', registered: '2018/02/01', role: 'Admin', status: 'Inactive'},
            {id: 19, name: 'Ganesha Dubhghall', registered: '2018/03/01', role: 'Member', status: 'Pending'},
            {id: 20, name: 'Hiroto Šimun', registered: '2018/01/21', role: 'Staff', status: 'Active'},
            {id: 21, name: 'Vishnu Serghei', registered: '2018/01/01', role: 'Member', status: 'Active'},
            {id: 22, name: 'Zbyněk Phoibos', registered: '2018/02/01', role: 'Staff', status: 'Banned'},
            {id: 23, name: 'Aulus Agmundr', registered: '2018/01/01', role: 'Member', status: 'Pending'},
            {id: 42, name: 'Ford Prefect', registered: '2001/05/25', role: 'Alien', status: 'Don\'t panic!'}
          ]

          const getBadge = (status)=>{
            switch (status) {
              case 'Active': return 'success'
              case 'Inactive': return 'secondary'
              case 'Pending': return 'warning'
              case 'Banned': return 'danger'
              default: return 'primary'
            }
          }

          var tableElement = document.getElementById('t1');
          console.log(tableElement);

          datatable = new coreui.Datatable(tableElement, {

            overTableSlot: '<h3>Over Table Slot</h3>',
            underTableSlot: '<h3>Under Table Slot</h3>',

            items: usersData,
            fields: fields,
            hover: true,
            columnFilter: true,
            pagination:true,
            itemsPerPageSelect: true,
            sorter: true,
            captionSlot: '<caption>Caption</caption>',
            tableFilter: true,
            footer: true,
            footerSlot: '', //?
            //

            // loading
            // onRowClick={(item,index,col,e) => console.log(item,index,col,e)}
            // onPageChange={(val) => console.log('new page:', val)}
            // onPagesChange={(val) => console.log('new pages:', val)}
            // onPaginationChange={(val) => console.log('new pagination:', val)}
            // onFilteredItemsChange={(val) => console.log('new filtered items:', val)}
            // onSorterValueChange={(val) => console.log('new sorter value:', val)}
            // onTableFilterChange={(val) => console.log('new table filter:', val)}
            // onColumnFilterChange={(val) => console.log('new column filter:', val)}

            scopedSlots: {
              'status':
                 pars =>{
                 //console.log('pars1', pars)
                 return `
                  <td>
                    <span class="badge badge-${getBadge(pars.item.status)}">
                      ${pars.item.status}
                    </span>
                  </td>
                `},
              'show_details':
                pars =>{
                  //console.log('pars2', pars)
                  return `
                    <td className="py-2">
                      <button
                        class="btn btn-outline-primary btn-square btn-sm"
                        onclick="toggleDetails(${pars.item.id})"
                      >
                        ${details.includes(pars.item.id) ? 'Hide' : 'Show'}
                      </button>
                    </td>
                  `},
              'details':
                  pars => {
                  //console.log('pars3', pars)
                  return details.includes(pars.item.id) ? `
                    <div>
                      <div class="card-body">
                        <h4>
                          ${pars.item.name}
                        </h4>
                        <p className="text-muted">User since: ${pars.item.registered}</p>
                        <button class="btn btn-sm btn-info">
                          User Settings
                        </button>
                        <button class="btn btn-sm btn-danger ml-1">
                          Delete
                        </button>
                      </dib>
                    </div>
                  ` : ''},
                'cleaner':
                  par => 'cleaner'
              }

            });


          // Pagination

          var paginationElement = document.getElementById('pag1');
          console.log(paginationElement);
          var pagination = new coreui.Pagination(paginationElement, {
          });


          // multi select

          var multiElement = document.getElementById('multi1');
          /*
          //old method
          var multiSelect = new coreui.MultiSelect(multiElement, {
            progress:50
          });
          */
          //new method
          multiSelect = coreui.MultiSelect.new(multiElement, {
            progress:50
          });
          console.log(multiSelect.test='test');
          //test: second initialization
          multiSelect = coreui.MultiSelect.new(multiElement);
          console.log(multiSelect.test); //'test'
          /*
          multiElement.addEventListener('start.coreui.loadingbutton', function () {
            console.log('start event');
          })
          */
          //multiSelect.open();
          console.log(multiSelect);

      }

      window.onload = main();
    </script>

  </body>
</html>
